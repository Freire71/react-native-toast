{"version":3,"names":["useEffect","useMemo","ActionType","dispatch","useStore","toast","useToaster","toastOptions","toasts","pausedAt","now","Date","timeouts","map","t","duration","Infinity","durationLeft","pauseDuration","createdAt","visible","dismiss","id","setTimeout","forEach","timeout","clearTimeout","handlers","startPause","type","START_PAUSE","time","endPause","END_PAUSE","updateHeight","toastId","height","UPDATE_TOAST","calculateOffset","opts","reverseOrder","gutter","defaultPosition","relevantToasts","filter","position","toastIndex","findIndex","toastsBefore","i","length","slice","reduce","acc"],"sources":["use-toaster.ts"],"sourcesContent":["import { useEffect, useMemo } from 'react';\nimport { ActionType, dispatch, useStore } from './store';\nimport { toast } from './toast';\nimport type { DefaultToastOptions, Toast, ToastPosition } from './types';\n\nexport const useToaster = (toastOptions?: DefaultToastOptions) => {\n  const { toasts, pausedAt } = useStore(toastOptions);\n\n  useEffect(() => {\n    if (pausedAt) {\n      return;\n    }\n\n    const now = Date.now();\n    const timeouts = toasts.map((t) => {\n      if (t.duration === Infinity) {\n        return;\n      }\n\n      const durationLeft =\n        (t.duration || 0) + t.pauseDuration - (now - t.createdAt);\n\n      if (durationLeft < 0) {\n        if (t.visible) {\n          toast.dismiss(t.id);\n        }\n        return;\n      }\n      return setTimeout(() => toast.dismiss(t.id), durationLeft);\n    });\n\n    return () => {\n      timeouts.forEach((timeout) => timeout && clearTimeout(timeout));\n    };\n  }, [toasts, pausedAt]);\n\n  const handlers = useMemo(\n    () => ({\n      startPause: () => {\n        dispatch({\n          type: ActionType.START_PAUSE,\n          time: Date.now(),\n        });\n      },\n      endPause: () => {\n        if (pausedAt) {\n          dispatch({ type: ActionType.END_PAUSE, time: Date.now() });\n        }\n      },\n      updateHeight: (toastId: string, height: number) =>\n        dispatch({\n          type: ActionType.UPDATE_TOAST,\n          toast: { id: toastId, height },\n        }),\n      calculateOffset: (\n        toast: Toast,\n        opts?: {\n          reverseOrder?: boolean;\n          gutter?: number;\n          defaultPosition?: ToastPosition;\n        }\n      ) => {\n        const {\n          reverseOrder = false,\n          gutter = 8,\n          defaultPosition,\n        } = opts || {};\n\n        const relevantToasts = toasts.filter(\n          (t) =>\n            (t.position || defaultPosition) ===\n              (toast.position || defaultPosition) && t.height\n        );\n        const toastIndex = relevantToasts.findIndex((t) => t.id === toast.id);\n        const toastsBefore = relevantToasts.filter(\n          (toast, i) => i < toastIndex && toast.visible\n        ).length;\n\n        return relevantToasts\n          .filter((t) => t.visible)\n          .slice(...(reverseOrder ? [toastsBefore + 1] : [0, toastsBefore]))\n          .reduce((acc, t) => acc + (t.height || 0) + gutter, 0);\n      },\n    }),\n    [toasts, pausedAt]\n  );\n\n  return {\n    toasts,\n    handlers,\n  };\n};\n"],"mappings":"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"}