{"version":3,"names":["useToaster","toastOptions","toasts","pausedAt","useStore","useEffect","now","Date","timeouts","map","t","duration","Infinity","durationLeft","pauseDuration","createdAt","visible","toast","dismiss","id","setTimeout","forEach","timeout","clearTimeout","handlers","useMemo","startPause","dispatch","type","ActionType","START_PAUSE","time","endPause","END_PAUSE","updateHeight","toastId","height","UPDATE_TOAST","calculateOffset","opts","reverseOrder","gutter","defaultPosition","relevantToasts","filter","position","toastIndex","findIndex","toastsBefore","i","length","slice","reduce","acc"],"sources":["use-toaster.ts"],"sourcesContent":["import { useEffect, useMemo } from 'react';\nimport { ActionType, dispatch, useStore } from './store';\nimport { toast } from './toast';\nimport type { DefaultToastOptions, Toast, ToastPosition } from './types';\n\nexport const useToaster = (toastOptions?: DefaultToastOptions) => {\n  const { toasts, pausedAt } = useStore(toastOptions);\n\n  useEffect(() => {\n    if (pausedAt) {\n      return;\n    }\n\n    const now = Date.now();\n    const timeouts = toasts.map((t) => {\n      if (t.duration === Infinity) {\n        return;\n      }\n\n      const durationLeft =\n        (t.duration || 0) + t.pauseDuration - (now - t.createdAt);\n\n      if (durationLeft < 0) {\n        if (t.visible) {\n          toast.dismiss(t.id);\n        }\n        return;\n      }\n      return setTimeout(() => toast.dismiss(t.id), durationLeft);\n    });\n\n    return () => {\n      timeouts.forEach((timeout) => timeout && clearTimeout(timeout));\n    };\n  }, [toasts, pausedAt]);\n\n  const handlers = useMemo(\n    () => ({\n      startPause: () => {\n        dispatch({\n          type: ActionType.START_PAUSE,\n          time: Date.now(),\n        });\n      },\n      endPause: () => {\n        if (pausedAt) {\n          dispatch({ type: ActionType.END_PAUSE, time: Date.now() });\n        }\n      },\n      updateHeight: (toastId: string, height: number) =>\n        dispatch({\n          type: ActionType.UPDATE_TOAST,\n          toast: { id: toastId, height },\n        }),\n      calculateOffset: (\n        toast: Toast,\n        opts?: {\n          reverseOrder?: boolean;\n          gutter?: number;\n          defaultPosition?: ToastPosition;\n        }\n      ) => {\n        const {\n          reverseOrder = false,\n          gutter = 8,\n          defaultPosition,\n        } = opts || {};\n\n        const relevantToasts = toasts.filter(\n          (t) =>\n            (t.position || defaultPosition) ===\n              (toast.position || defaultPosition) && t.height\n        );\n        const toastIndex = relevantToasts.findIndex((t) => t.id === toast.id);\n        const toastsBefore = relevantToasts.filter(\n          (toast, i) => i < toastIndex && toast.visible\n        ).length;\n\n        return relevantToasts\n          .filter((t) => t.visible)\n          .slice(...(reverseOrder ? [toastsBefore + 1] : [0, toastsBefore]))\n          .reduce((acc, t) => acc + (t.height || 0) + gutter, 0);\n      },\n    }),\n    [toasts, pausedAt]\n  );\n\n  return {\n    toasts,\n    handlers,\n  };\n};\n"],"mappings":"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"}